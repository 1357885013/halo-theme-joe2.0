!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o=t();for(var a in o)("object"==typeof exports?exports:e)[a]=o[a]}}(self,(function(){return e=null,t={initReadLimit:function(){var t=$(".page-post .joe_detail__article"),o=$("joe-hide");if(o.length){var a=$(".joe_detail").attr("data-cid");if(o.length>1){var n=o.eq(o.length-1);n.addClass("marker"),o=n,$("joe-hide:not(.marker)").parent().remove()}t.attr("data-partial","true");var i=function(e,t){var o=localStorage.getItem("partialIds");o&&o.includes(e)?$("joe-hide").parent().remove():t&&t(e)},r=function(){var t=localStorage.getItem("partialIds"),n=o.offset().top;e.replaceAll(o.parent()),localStorage.setItem("partialIds",t?t+","+a:a),e=null,commonContext.initCode(!0),commonContext.initGallery(),commonContext.initPDF(),tocbot.refresh(),window.scrollTo({top:n-150})};i(a,(function(){var t=o.parent().nextAll();e=t,t.remove(),document.getElementsByTagName("halo-comment")[0].addEventListener("post-success",(function(e){i(a,r)}))}))}t.addClass("show")},initCopy:function(){if("false"!==PageAttrs.metas.enable_copy&&ThemeConfig.enable_copy){var e=location.href,t=$(".joe_detail").attr("data-author");$(".joe_detail__article").on("copy",(function(o){var a=window.getSelection(),n=a.toString().replace(/<已自动折叠>/g,""),i=ThemeConfig.enable_copy_right_text?ThemeConfig.copy_right_text||"\r\n\r\n====================================<br>作者：".concat(t,"<br>来源：").concat(ThemeConfig.blog_title,"<br>链接：").concat(e,"<br>版权声明：内容遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。"):"";if(window.clipboardData){var r=n+i;return window.clipboardData.setData("Text",r),!1}var c=document.body,l=n+i,s=document.createElement("pre");s.style.position="absolute",s.style.left="-99999px",c.appendChild(s),s.innerHTML=l,a.selectAllChildren(s),setTimeout((function(){c.removeChild(s)}),0)}))}},initShare:function(){"false"!==PageAttrs.metas.enable_share&&ThemeConfig.enable_share&&(ThemeConfig.enable_share_link&&$(".icon-share-link").length&&$(".icon-share-link").each((function(e,t){new ClipboardJS($(t)[0],{text:function(){return location.href}}).on("success",(function(){return Qmsg.success("文章链接已复制")}))})),ThemeConfig.enable_share_weixin&&$(".qrcode_wx").length&&$(".qrcode_wx").qrcode({width:140,height:140,render:"canvas",typeNumber:-1,correctLevel:0,background:"#ffffff",foreground:"#000000",text:location.href}))},initLike:function(){if("false"!==PageAttrs.metas.enable_like&&ThemeConfig.enable_like&&$(".joe_detail__agree").length){var e=$(".joe_detail").attr("data-cid"),t=+($(".joe_detail").attr("data-clikes")||0),o=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[],a=o.includes(e),n=$(".joe_detail__agree, .post-operate-like"),i=n.find(".icon-like"),r=n.find(".icon-unlike"),c=n.find(".nums");a?r.addClass("active"):i.addClass("active"),c.html(t);var l=!1;i.on("click",(function(s){s.stopPropagation(),l||(l=!0,o=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[],a=o.includes(e),Utils.request("/api/content/posts/"+e+"/likes","POST",{type:a?"disagree":"agree"}).then((function(l){var s=t;if(a){s--;var d=o.findIndex((function(t){return t===e}));o.splice(d,1),r.removeClass("active"),i.addClass("active"),n.removeClass("active")}else s++,o.push(e),i.removeClass("active"),r.addClass("active"),n.addClass("active");var f=encryption("agree"),p=encryption(JSON.stringify(o));localStorage.setItem(f,p),c.html(s)})).catch((function(e){l=!1})))}))}},initToc:function(){"false"!==PageAttrs.metas.enable_toc&&ThemeConfig.enable_toc&&$(".toc-container").length&&(document.body.clientWidth<=992||(tocbot.init({tocSelector:"#js-toc",contentSelector:".joe_detail__article",ignoreSelector:".js-toc-ignore",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:+(PageAttrs.metas.toc_depth||ThemeConfig.toc_depth||0),hasInnerContainers:!1,headingsOffset:80,scrollSmoothOffset:-80,positionFixedSelector:".toc-container",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"}),$("#js-toc").children().length||$("#js-toc").html('<div class="toc-nodata">暂无目录</div>'),$(".toc-container").show()))},initAsideOperate:function(){$(".post-operate-comment").on("click",(function(e){var t=document.querySelector(".joe_comment"),o=document.querySelector(".joe_header");if(t&&o)if(e.stopPropagation(),document.getElementsByTagName("halo-comment").length){var a=t.offsetTop-o.offsetHeight-15;window.scrollTo({top:a})}else Qmsg.warning("评论功能不可用！")}))},initProgress:function(){if(ThemeConfig.enable_progress_bar){$(window).off("scroll");var e,t,o,a=$(".joe_progress_bar");$(window).on("scroll",(function(n){n.stopPropagation(),e=$(window).height(),t=$("body").height(),o=t-e,window.requestAnimationFrame((function(){var e;e=Math.max(0,Math.min(1,$(window).scrollTop()/o)),a.css("width",100*e+"%")}))}))}},initVideo:function(){if($(".joe_detail__article-video").length){var e=$(".joe_detail__article-video .play iframe").attr("data-player");$(".joe_detail__article-video .episodes .item").on("click",(function(t){t.stopPropagation(),$(this).addClass("active").siblings().removeClass("active");var o=$(this).attr("data-src");$(".joe_detail__article-video .play iframe").attr({src:e+o})})),$(".joe_detail__article-video .episodes .item").first().click()}}},document.addEventListener("DOMContentLoaded",(function(){Object.keys(t).forEach((function(e){return t[e]()}))})),{};var e,t}));