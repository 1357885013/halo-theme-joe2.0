var Utils={_version:"1.0.0",isMobile:()=>!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)),timeAgo(time){if(!time)return"未知时间";time=new Date(time).getTime();var between=(new Date).getTime()-time,days=Math.floor(between/864e5);if(0===days){var leave1=between%864e5,hours=Math.floor(leave1/36e5);if(0===hours){var leave2=leave1%36e5,minutes=Math.floor(leave2/6e4);if(0===minutes){var leave3=leave2%6e4,seconds=Math.round(leave3/1e3);return seconds<1?"刚刚":seconds+" 秒前"}return minutes+" 分钟前"}return hours+" 小时前"}return days<0?"刚刚":1===days?"昨天":Utils.formatDate(time,"yyyy年MM月dd日 hh:mm")},formatDate(date,fmt="yyyy-MM-dd"){date=new Date(date),/(y+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length)));let o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds()};for(let k in o)if(new RegExp(`(${k})`).test(fmt)){let str=o[k]+"";fmt=fmt.replace(RegExp.$1,1===RegExp.$1.length?str:str.padStart(2,"0"))}return fmt},getNavLangSub(){var currentLang=navigator.language;return(currentLang=currentLang.substr(0,2))||(currentLang=navigator.browserLanguage),currentLang},request:(url,method="GET",data)=>new Promise((resolve,reject)=>{$.ajax({url:`${url}?_r=${Date.now()}`,type:method.toUpperCase(),headers:{"API-Authorization":ThemeConfig.AccessKey},dataType:"json",data:data,success(res){200===res.status&&res.data?resolve(res.data):reject(res)},failed(err){reject(err||"出错了！")}})}),throttle(fn,threshold=250){let timer,last;return function(){const context=this,args=[...arguments],now=Date.now();last&&last+threshold>now?(clearTimeout(timer),timer=null,timer=setTimeout(()=>{last=now,fn.apply(context,args)},threshold)):(last=now,fn.apply(context,args))}},setCookie(key,value,days){var keyVE=key+Utils._version,expires="";if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toUTCString()}document.cookie=keyVE+"="+(value||"")+expires+"; path=/"},getCookie(key){for(var keyVE=key+Utils._version+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(keyVE))return c.substring(keyVE.length,c.length)}return null},removeCookie(key){var keyVE=key+Utils._version+"=";document.cookie=keyVE+"=; Max-Age=-99999999;"},setLocalStorage(key,value,expires=3600){var keyVE=key+Utils._version,date=new Date;try{localStorage.setItem(keyVE,JSON.stringify({expires:date.valueOf()+1e3*expires,data:value}))}catch(e){"QuotaExceededError"===e.name&&(console.log("数据已满，自动清空"),localStorage.clear(),setLocalStorage(key,value,expires))}},getLocalStorage(key){var keyVE=key+Utils._version,result=JSON.parse(localStorage.getItem(keyVE)),date=new Date;return result&&result.expires>date?result.data:(localStorage.removeItem(keyVE),null)},removeLocalStorage(key){var keyVE=key+Utils._version;localStorage.removeItem(keyVE)},loadJS(url,callback){Utils._loadRes("script",url,callback)},loadCSS(url,callback){Utils._loadRes("link",url,callback)},_loadRes(type,url,callback){var dom,fn=callback||function(){};switch(type){case"script":(dom=document.createElement(type)).type="text/javascript",dom.src=url;break;case"link":(dom=document.createElement(type)).type="text/css",dom.type="stylesheet",dom.href=url;break;default:return void console.warn("暂不支持："+type+" 类型")}dom.readyState?dom.onreadystatechange=function(){"loaded"!=dom.readyState&&"complete"!=dom.readyState||(dom.onreadystatechange=null,fn())}:dom.onload=function(){fn()},document.getElementsByTagName("head")[0].appendChild(dom)},getRandomColor(min=0,max=1){return min||(min=0),max||(max=0),min=isNaN(min)?0:Number(min),max=isNaN(max)?1:Number(max),min=Math.min(Math.max(Math.abs(min),0),1),max=(max=Math.min(Math.max(Math.abs(max),0),1))<min?1:max,"#"+(h=(16777216*(Math.random()*(max-min)+min)<<0).toString(16),new Array(7-h.length).join("0")+h);var h},getNearestKeyframe(keyframesIndex,milliseconds){var keyframeIdx=this._search(keyframesIndex.times,milliseconds);return{index:keyframeIdx,milliseconds:table.times[keyframeIdx],fileposition:table.filepositions[keyframeIdx]}},_search(list,value){var idx=0,last=list.length-1,mid=0,lbound=0,ubound=last;for(value<list[0]&&(idx=0,lbound=ubound+1);lbound<=ubound;){if((mid=lbound+Math.floor((ubound-lbound)/2))===last||value>=list[mid]&&value<list[mid+1]){idx=mid;break}list[mid]<value?lbound=mid+1:ubound=mid-1}return idx},removeClassByPrefix(el,prefix){var classes=el.className.split(" ").filter((function(c){return 0!==c.lastIndexOf(prefix,0)}));el.className=classes.join(" ").trim()}};window.Utils=Utils;