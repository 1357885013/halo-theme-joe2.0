const encryption=str=>window.btoa(unescape(encodeURIComponent(str))),decrypt=str=>decodeURIComponent(escape(window.atob(str))),JoeContext={initCommentTheme(){const comments=document.getElementsByTagName("halo-comment"),curMode=$("html").attr("data-mode");for(var i=0;i<comments.length;i++){var shadowDom=comments[i].shadowRoot.getElementById("halo-comment");$(shadowDom)[`${"light"===curMode?"remove":"add"}Class`]("dark")}},initNavbar(){var $nav_menus=$(".joe_header__above-nav a"),$nav_side_menus=$(".panel-side-menu .link"),activeIndex=0,curPath=location.pathname;curPath&&"/"!==curPath&&$nav_menus.each((index,item)=>{curPath.indexOf(item.getAttribute("href"))>-1&&(activeIndex=index)}),$nav_menus.eq(activeIndex).addClass("current"),$nav_side_menus.eq(activeIndex).addClass("current")},initMode(){var $html=$("html"),$icon_light=$(".mode-light"),$icon_dark=$(".mode-dark");if(ThemeConfig.static_theme)$html.attr("data-mode",ThemeConfig.static_theme);else if(ThemeConfig.enable_auto_switch_theme){var local_theme=sessionStorage.getItem("data-mode");if(localStorage.removeItem("data-mode",theme),local_theme)$html.attr("data-mode",local_theme),"light"===local_theme?($icon_light.removeClass("active"),$icon_dark.addClass("active")):($icon_light.addClass("active"),$icon_dark.removeClass("active"));else{var light_scope=ThemeConfig.dark_time_scope.split("~"),now=new Date,today=now.toLocaleString().split(" ")[0];"light"===(theme=now>=new Date(today+" "+light_scope[0])&&now<=new Date(today+" "+light_scope[1])?"light":"dark")?($icon_light.removeClass("active"),$icon_dark.addClass("active")):($icon_light.addClass("active"),$icon_dark.removeClass("active")),$html.attr("data-mode",theme),sessionStorage.setItem("data-mode",theme)}}else{var theme=localStorage.getItem("data-mode")||"light";$(".mode-"+("light"===theme?"dark":"light")).addClass("active"),$html.attr("data-mode",theme)}JoeContext.initCommentTheme(),$(".joe_action_item.mode").on("click",(function(){var curSource=ThemeConfig.enable_auto_switch_theme?sessionStorage:localStorage,theme="";(local_theme=curSource.getItem("data-mode"))?"light"===local_theme?(theme="dark",$icon_dark.removeClass("active"),$icon_light.addClass("active")):(theme="light",$icon_light.removeClass("active"),$icon_dark.addClass("active")):(theme="dark",$icon_light.removeClass("active"),$icon_dark.addClass("active")),$html.attr("data-mode",theme),curSource.setItem("data-mode",theme),initCommentTheme()}))},dynamicBg(){Joe.IS_MOBILE||"off"===Joe.DYNAMIC_BACKGROUND||!Joe.DYNAMIC_BACKGROUND||Joe.WALLPAPER_BACKGROUND_PC||$.getScript(window.Joe.THEME_URL+`assets/backdrop/${Joe.DYNAMIC_BACKGROUND}`)},initFavicon(){if(ThemeConfig.favicon){var favicon=new Favico,image=new Image;image.onload=function(){favicon.image(image)},image.src=ThemeConfig.favicon}},initSearchPop(){$(".joe_header__above-search .input").on("click",(function(e){e.stopPropagation(),$(".joe_header__above-search .result").addClass("active")})),$(document).on("click",(function(){$(".joe_header__above-search .result").removeClass("active")}))},initDrop(){$(".joe_dropdown").each((function(index,item){const menu=$(this).find(".joe_dropdown__menu"),trigger=$(item).attr("trigger")||"click",placement=$(item).attr("placement")||$(this).height()||0;menu.css("top",placement),"hover"===trigger?$(this).hover(()=>$(this).addClass("active"),()=>$(this).removeClass("active")):($(this).on("click",(function(e){$(this).toggleClass("active"),$(document).one("click",()=>$(this).removeClass("active")),e.stopPropagation()})),menu.on("click",e=>e.stopPropagation()))}))},initBack2top(){let _debounce=null;const handleScroll=()=>(document.documentElement.scrollTop||document.body.scrollTop)>300?$(".joe_action_item.scroll").addClass("active"):$(".joe_action_item.scroll").removeClass("active");handleScroll(),$(document).on("scroll",()=>{clearTimeout(_debounce),_debounce=setTimeout(handleScroll,80)}),$(".joe_action_item.scroll").on("click",()=>window.scrollTo({top:0,behavior:"smooth"}))},initCountup(){if($(".joe_aside__item.timelife").length){let timelife=[{title:"今日已经过去",endTitle:"小时",num:0,percent:"0%"},{title:"这周已经过去",endTitle:"天",num:0,percent:"0%"},{title:"本月已经过去",endTitle:"天",num:0,percent:"0%"},{title:"今年已经过去",endTitle:"个月",num:0,percent:"0%"}];{let todayPassHours=(+new Date-new Date((new Date).toLocaleDateString()).getTime())/1e3/60/60,todayPassHoursPercent=todayPassHours/24*100;timelife[0].num=parseInt(todayPassHours),timelife[0].percent=parseInt(todayPassHoursPercent)+"%"}{let weekDay={0:7,1:1,2:2,3:3,4:4,5:5,6:6}[(new Date).getDay()],weekDayPassPercent=weekDay/7*100;timelife[1].num=parseInt(weekDay),timelife[1].percent=parseInt(weekDayPassPercent)+"%"}{let year=(new Date).getFullYear(),date=(new Date).getDate(),month=(new Date).getMonth()+1,monthPassPercent=date/new Date(year,month,0).getDate()*100;timelife[2].num=date,timelife[2].percent=parseInt(monthPassPercent)+"%"}{let month=(new Date).getMonth()+1,yearPass=month/12*100;timelife[3].num=month,timelife[3].percent=parseInt(yearPass)+"%"}let htmlStr="";timelife.forEach((item,index)=>{htmlStr+=`\n\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t<div class="title">\n\t\t\t\t\t\t\t\t${item.title}\n\t\t\t\t\t\t\t\t<span class="text">${item.num}</span>\n\t\t\t\t\t\t\t\t${item.endTitle}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="progress">\n\t\t\t\t\t\t\t\t<div class="progress-bar">\n\t\t\t\t\t\t\t\t\t<div class="progress-bar-inner progress-bar-inner-${index}" style="width: ${item.percent}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="progress-percentage">${item.percent}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`}),$(".joe_aside__item.timelife .joe_aside__item-contain").html(htmlStr)}},initWeather(){if($(".joe_aside__item.weather").length){const key=$(".joe_aside__item.weather").attr("data-key"),style=$(".joe_aside__item.weather").attr("data-style"),aqiColor={1:"FFFFFF",2:"4A4A4A",3:"FFFFFF"};window.WIDGET={CONFIG:{layout:2,width:"220",height:"270",background:style,dataColor:aqiColor[style],language:"zh",key:key}},$.getScript("https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0")}},init3Dtag(){if(!ThemeConfig.show_tag_cloud)return;const entries=[],colors=["#F8D800","#0396FF","#EA5455","#7367F0","#32CCBC","#F6416C","#28C76F","#9F44D3","#F55555","#736EFE","#E96D71","#DE4313","#D939CD","#4C83FF","#F072B6","#C346C2","#5961F9","#FD6585","#465EFB","#FFC600","#FA742B","#5151E5","#BB4E75","#FF52E5","#49C628","#00EAFF","#F067B4","#F067B4","#ff9a9e","#00f2fe","#4facfe","#f093fb","#6fa3ef","#bc99c4","#46c47c","#f9bb3c","#e8583d","#f68e5f"];$(".tags-cloud-list li").each((i,item)=>{var min,max;entries.push({label:$(item).attr("data-label"),url:$(item).attr("data-url"),target:"_blank",fontColor:colors[(min=0,max=colors.length-1,min=Math.ceil(min),max=Math.floor(max),Math.floor(Math.random()*(max-min+1))+min)],fontSize:15})}),$("#tags-3d").svg3DTagCloud({entries:entries,width:250,height:250,radius:"65%",radiusMin:75,bgDraw:!1,fov:800,speed:.5,fontWeight:500}),$(".tags-cloud-list").remove()},initLive2d(){"off"!==Joe.LIVE2D&&Joe.LIVE2D&&$.getScript("https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.min.js",()=>{L2Dwidget.init({model:{jsonPath:Joe.LIVE2D,scale:1},mobile:{show:!1},display:{position:"right",width:160,height:200,hOffset:70,vOffset:0}})})},offscreenTip(){if(ThemeConfig.enable_offscreen_tip){var titleTime,OriginTitile=document.title;document.addEventListener("visibilitychange",(function(){location.href.indexOf(ThemeConfig.blog_url)>0||"/"!==location.pathname||(document.hidden?(document.title=ThemeConfig.offscreen_title_leave||"歪，你去哪里了？",clearTimeout(titleTime)):(document.title=ThemeConfig.offscreen_title_back||"(つェ⊂)咦，又回来了!",titleTime=setTimeout((function(){document.title=OriginTitile}),2e3)))}))}},mobileSideMenu(){$(".joe_header__above-slideicon").on("click",(function(){$(".joe_header__searchout").removeClass("active"),$(".joe_header__slideout").hasClass("active")?($("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__slideout").removeClass("active")):($("body").css("overflow","hidden"),$(".joe_header__mask").addClass("active slideout"),$(".joe_header__slideout").addClass("active"))}))},mobileSearch(){$(".joe_header__above-searchicon").on("click",(function(){$(".joe_header__slideout").removeClass("active"),$(".joe_header__searchout").hasClass("active")?($("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__searchout").removeClass("active")):($("body").css("overflow","hidden"),$(".joe_header__mask").addClass("active"),$(".joe_header__searchout").addClass("active"))}))},maskClose(){$(".joe_header__mask").on("click",(function(){$("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__searchout").removeClass("active"),$(".joe_header__slideout").removeClass("active")}))},initSideMenu(){$(".joe_header__slideout-menu .current").parents(".panel-body").show().siblings(".panel").addClass("in"),$(".joe_header__slideout-menu .panel").on("click",(function(){const panelBox=$(this).parent().parent();panelBox.find(".panel").not($(this)).removeClass("in"),panelBox.find(".panel-body").not($(this).siblings(".panel-body")).stop().hide("fast"),$(this).toggleClass("in").siblings(".panel-body").stop().toggle("fast")}))},initRuntime(){const getRunTime=()=>{const birthDay=new Date(ThemeConfig.birthday);let day=(+new Date-birthDay.getTime())/864e5,dayPast=Math.floor(day),hour=24*(day-dayPast),hourPast=Math.floor(hour),minute=60*(hour-hourPast),minutePast=Math.floor(minute),second=60*(minute-minutePast),secondPast=Math.floor(second);day=String(dayPast).padStart(2,0),hour=String(hourPast).padStart(2,0),minute=String(minutePast).padStart(2,0),second=String(secondPast).padStart(2,0),$(".joe_run__day").html(day),$(".joe_run__hour").html(hour),$(".joe_run__minute").html(minute),$(".joe_run__second").html(second)};ThemeConfig.birthday&&/(\d{4})\/(\d{1,2})\/(\d{1,2}) (\d{1,2})\:(\d{1,2})\:(\d{1,2})/.test(ThemeConfig.birthday)&&(getRunTime(),setInterval(getRunTime,1e3))},initEmoji(){$(".joe_owo__contain").length&&$(".joe_owo__target").length&&$.ajax({url:window.Joe.THEME_URL+"assets/json/joe.owo.json",dataType:"json",success(res){let barStr="",scrollStr="";for(let key in res){const item=res[key];barStr+=`<div class="item" data-type="${key}">${key}</div>`,scrollStr+=`\n                            <ul class="scroll" data-type="${key}">\n\t\t\t\t\t\t\t\t${item.map(_=>`<li class="item" data-text="${_.data}">${"颜文字"===key?`${_.icon}`:`<img src="${window.Joe.THEME_URL+_.icon}" alt="${_.data}"/>`}</li>`).join("")}\n                            </ul>\n                        `}$(".joe_owo__contain").html(`\n                        <div class="seat">OωO</div>\n                        <div class="box">\n                            ${scrollStr}\n                            <div class="bar">${barStr}</div>\n                        </div>\n                    `),$(document).on("click",(function(){$(".joe_owo__contain .box").stop().slideUp("fast")})),$(".joe_owo__contain .seat").on("click",(function(e){e.stopPropagation(),$(this).siblings(".box").stop().slideToggle("fast")})),$(".joe_owo__contain .box .bar .item").on("click",(function(e){e.stopPropagation(),$(this).addClass("active").siblings().removeClass("active");const scrollIndx='.joe_owo__contain .box .scroll[data-type="'+$(this).attr("data-type")+'"]';$(scrollIndx).show().siblings(".scroll").hide()})),$(".joe_owo__contain .scroll .item").on("click",(function(){const text=$(this).attr("data-text");$(".joe_owo__target").insertContent(text)})),$(".joe_owo__contain .box .bar .item").first().click()}})},headerScroll(){if(!window.Joe.IS_MOBILE){let flag=!0;const handleHeader=diffY=>{if(window.pageYOffset>=$(".joe_header").height()&&diffY<=0){if(flag)return;$(".joe_header").addClass("active"),$(".joe_aside .joe_aside__item:last-child").css("top",$(".joe_header").height()-60+15),flag=!0}else{if(!flag)return;$(".joe_header").removeClass("active"),$(".joe_aside .joe_aside__item:last-child").css("top",$(".joe_header").height()+15),flag=!1}};let Y=window.pageYOffset;handleHeader(Y);let _last=Date.now();document.addEventListener("scroll",()=>{let _now=Date.now();_now-_last>15&&(handleHeader(Y-window.pageYOffset),Y=window.pageYOffset),_last=_now})}},initSwiper(){0!==$(".joe_index__banner .swiper-container").length&&new Swiper(".swiper-container",{keyboard:!1,loop:!0,direction:ThemeConfig.banner_direction,autoplay:!!ThemeConfig.enable_banner_autoplay&&{delay:ThemeConfig.banner_delay,disableOnInteraction:!1},mousewheel:!1,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},initRecommend(){let queryData={page:1,pageSize:window.Joe.PAGE_SIZE,type:"created"};const pushDom=()=>new Promise((reslove,reject)=>{$(".joe_load").attr("loading",!0),$(".joe_load").html("loading..."),$(".joe_index__list .joe_list__loading").show(),$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"publish_list",page:queryData.page,pageSize:queryData.pageSize,type:queryData.type},success(res){if(0===res.data.length)return $(".joe_load").removeAttr("loading"),$(".joe_load").html("查看更多"),$(".joe_load").hide(),$(".joe_index__list .joe_list__loading").hide(),Qmsg.warning("没有更多内容了");res.data.forEach(_=>$(".joe_index__list .joe_list").append((_=>"default"===_.mode?`\n                    <li class="joe_list__item wow default">\n                        <div class="line"></div>\n                        <a href="${_.permalink}" class="thumbnail" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                            <img width="100%" height="100%" class="lazyload" src="${_.lazyload}" data-src="${_.image[0]}" alt="${_.title}" />\n                            <time datetime="${_.time}">${_.time}</time>\n                            <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M903.93 107.306H115.787c-51.213 0-93.204 42.505-93.204 93.72V825.29c0 51.724 41.99 93.717 93.717 93.717h788.144c51.72 0 93.717-41.993 93.717-93.717V201.025c-.512-51.214-43.017-93.719-94.23-93.719zm-788.144 64.527h788.657c16.385 0 29.704 13.316 29.704 29.704v390.229L760.54 402.285c-12.805-13.828-30.217-21.508-48.14-19.971-17.924 1.02-34.821 10.754-46.602 26.114l-172.582 239.16-87.06-85.52c-12.29-11.783-27.654-17.924-44.039-17.924-16.39.508-31.755 7.676-43.53 20.48L86.595 821.705V202.05c-1.025-17.416 12.804-30.73 29.191-30.217zm788.145 683.674H141.906l222.255-245.82 87.06 86.037c12.8 12.807 30.212 18.95 47.115 17.417 17.41-1.538 33.797-11.266 45.063-26.118l172.584-238.647 216.111 236.088 2.051-1.54V825.8c.509 16.39-13.315 29.706-30.214 29.706zm0 0"/><path d="M318.072 509.827c79.89 0 144.417-65.037 144.417-144.416 0-79.378-64.527-144.925-144.417-144.925-79.891 0-144.416 64.527-144.416 144.412 0 79.892 64.525 144.93 144.416 144.93zm0-225.327c44.553 0 80.912 36.362 80.912 80.91 0 44.557-35.847 81.43-80.912 81.43-45.068 0-80.916-36.36-80.916-80.915 0-44.556 36.872-81.425 80.916-81.425zm0 0"/></svg>\n                        </a>\n                        <div class="information">\n                            <a href="${_.permalink}" class="title" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                                <span class="badge" style="display: ${"sticky"===_.type?"inline-block":"none"}">置顶</span>${_.title}\n                            </a>\n                            <a class="abstract" href="${_.permalink}" title="文章摘要" target="_blank" rel="noopener noreferrer">${_.abstract}</a>\n                            <div class="meta">\n                                <ul class="items">\n                                    <li>${_.created}</li>\n                                    <li>${_.views} 阅读</li>\n                                    <li>${_.commentsNum} 评论</li>\n                                    <li>${_.agree} 点赞</li>\n                                </ul>\n                                <div class="last" style="display: ${_.category.length?"flex":"none"}">\n                                    <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M512.2 564.743a76.818 76.818 0 0 1-30.973-6.508L108.224 393.877c-26.105-11.508-42.56-35.755-42.927-63.272-.384-27.44 15.356-52.053 41.042-64.232l373.004-176.74c20.591-9.737 45.16-9.755 65.75.017L917.68 266.39c25.668 12.188 41.39 36.792 41.024 64.231-.384 27.5-16.821 51.73-42.908 63.237l-372.57 164.377a77.18 77.18 0 0 1-31.025 6.508zM139.843 329.592l370.213 163.241c1.291.56 3.018.567 4.345-.009l369.758-163.128-369.706-175.464v-.01c-1.326-.628-3.158-.636-4.502 0l-370.108 175.37zm748.015 1.858h.175-.175zM512.376 941.674c-10.348 0-20.8-2.32-30.537-6.997L121.05 778.624c-18.113-7.834-26.454-28.87-18.62-46.983 7.835-18.112 28.862-26.488 46.993-18.61l362.08 156.629 345.26-156.366c17.939-8.166 39.14-.253 47.324 17.746 8.166 17.964.227 39.157-17.729 47.324l-344.51 156.61c-9.196 4.449-19.281 6.7-29.471 6.7z" fill="#444"/><path d="M871.563 515.449L511.81 671.775 152.358 515.787v73.578a34.248 34.248 0 0 0 20.76 31.48l301.518 129.19c11.806 5.703 24.499 8.546 37.175 8.546s25.367-2.843 37.174-8.546L850.82 620.534a34.248 34.248 0 0 0 20.744-31.474V515.45z" fill="#ff6a18"/></svg>\n                                    <a class="link" target="_blank" rel="noopener noreferrer" href="${_.category.length&&_.category[0].permalink}">${_.category.length&&_.category[0].name}</a>\n                                </div>\n                            </div>\n                        </div>\n                    </li>\n                `:"single"===_.mode?`\n                    <li class="joe_list__item wow single">\n                        <div class="line"></div>\n                        <div class="information">\n                            <a href="${_.permalink}" class="title" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                                <span class="badge" style="display: ${"sticky"===_.type?"inline-block":"none"}">置顶</span>${_.title}\n                            </a>\n                            <div class="meta">\n                                <ul class="items">\n                                    <li>${_.created}</li>\n                                    <li>${_.views} 阅读</li>\n                                    <li>${_.commentsNum} 评论</li>\n                                    <li>${_.agree} 点赞</li>\n                                </ul>\n                                <div class="last" style="display: ${_.category.length?"flex":"none"}">\n                                    <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M512.2 564.743a76.818 76.818 0 0 1-30.973-6.508L108.224 393.877c-26.105-11.508-42.56-35.755-42.927-63.272-.384-27.44 15.356-52.053 41.042-64.232l373.004-176.74c20.591-9.737 45.16-9.755 65.75.017L917.68 266.39c25.668 12.188 41.39 36.792 41.024 64.231-.384 27.5-16.821 51.73-42.908 63.237l-372.57 164.377a77.18 77.18 0 0 1-31.025 6.508zM139.843 329.592l370.213 163.241c1.291.56 3.018.567 4.345-.009l369.758-163.128-369.706-175.464v-.01c-1.326-.628-3.158-.636-4.502 0l-370.108 175.37zm748.015 1.858h.175-.175zM512.376 941.674c-10.348 0-20.8-2.32-30.537-6.997L121.05 778.624c-18.113-7.834-26.454-28.87-18.62-46.983 7.835-18.112 28.862-26.488 46.993-18.61l362.08 156.629 345.26-156.366c17.939-8.166 39.14-.253 47.324 17.746 8.166 17.964.227 39.157-17.729 47.324l-344.51 156.61c-9.196 4.449-19.281 6.7-29.471 6.7z" fill="#444"/><path d="M871.563 515.449L511.81 671.775 152.358 515.787v73.578a34.248 34.248 0 0 0 20.76 31.48l301.518 129.19c11.806 5.703 24.499 8.546 37.175 8.546s25.367-2.843 37.174-8.546L850.82 620.534a34.248 34.248 0 0 0 20.744-31.474V515.45z" fill="#ff6a18"/></svg>\n                                    <a class="link" target="_blank" rel="noopener noreferrer" href="${_.category.length&&_.category[0].permalink}">${_.category.length&&_.category[0].name}</a>\n                                </div>\n                            </div>\n                        </div>\n                        <a href="${_.permalink}" class="thumbnail" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                            <img width="100%" height="100%" class="lazyload" src="${_.lazyload}" data-src="${_.image[0]}" alt="${_.title}" />\n                            <time datetime="${_.time}">${_.time}</time>\n                            <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M903.93 107.306H115.787c-51.213 0-93.204 42.505-93.204 93.72V825.29c0 51.724 41.99 93.717 93.717 93.717h788.144c51.72 0 93.717-41.993 93.717-93.717V201.025c-.512-51.214-43.017-93.719-94.23-93.719zm-788.144 64.527h788.657c16.385 0 29.704 13.316 29.704 29.704v390.229L760.54 402.285c-12.805-13.828-30.217-21.508-48.14-19.971-17.924 1.02-34.821 10.754-46.602 26.114l-172.582 239.16-87.06-85.52c-12.29-11.783-27.654-17.924-44.039-17.924-16.39.508-31.755 7.676-43.53 20.48L86.595 821.705V202.05c-1.025-17.416 12.804-30.73 29.191-30.217zm788.145 683.674H141.906l222.255-245.82 87.06 86.037c12.8 12.807 30.212 18.95 47.115 17.417 17.41-1.538 33.797-11.266 45.063-26.118l172.584-238.647 216.111 236.088 2.051-1.54V825.8c.509 16.39-13.315 29.706-30.214 29.706zm0 0"/><path d="M318.072 509.827c79.89 0 144.417-65.037 144.417-144.416 0-79.378-64.527-144.925-144.417-144.925-79.891 0-144.416 64.527-144.416 144.412 0 79.892 64.525 144.93 144.416 144.93zm0-225.327c44.553 0 80.912 36.362 80.912 80.91 0 44.557-35.847 81.43-80.912 81.43-45.068 0-80.916-36.36-80.916-80.915 0-44.556 36.872-81.425 80.916-81.425zm0 0"/></svg>\n                        </a>\n                        <div class="information" style="margin-bottom: 0;">\n                            <a class="abstract" href="${_.permalink}" title="文章摘要" target="_blank" rel="noopener noreferrer">${_.abstract}</a>\n                        </div>\n                    </li>\n                `:"multiple"===_.mode?`\n                    <li class="joe_list__item wow multiple">\n                        <div class="line"></div>\n                        <div class="information">\n                            <a href="${_.permalink}" class="title" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                                <span class="badge" style="display: ${"sticky"===_.type?"inline-block":"none"}">置顶</span>${_.title}\n                            </a>\n                            <a class="abstract" href="${_.permalink}" title="文章摘要" target="_blank" rel="noopener noreferrer">${_.abstract}</a>\n                        </div>\n                        <a href="${_.permalink}" class="thumbnail" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                            ${_.image.map((item,index)=>{if(index<3)return`<img width="100%" height="100%" class="lazyload" src="${_.lazyload}" data-src="${item}" alt="${_.title}" />`}).join("")}\n                        </a>\n                        <div class="meta">\n                            <ul class="items">\n                                <li>${_.created}</li>\n                                <li>${_.views} 阅读</li>\n                                <li>${_.commentsNum} 评论</li>\n                                <li>${_.agree} 点赞</li>\n                            </ul>\n                            <div class="last" style="display: ${_.category.length?"flex":"none"}">\n                                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M512.2 564.743a76.818 76.818 0 0 1-30.973-6.508L108.224 393.877c-26.105-11.508-42.56-35.755-42.927-63.272-.384-27.44 15.356-52.053 41.042-64.232l373.004-176.74c20.591-9.737 45.16-9.755 65.75.017L917.68 266.39c25.668 12.188 41.39 36.792 41.024 64.231-.384 27.5-16.821 51.73-42.908 63.237l-372.57 164.377a77.18 77.18 0 0 1-31.025 6.508zM139.843 329.592l370.213 163.241c1.291.56 3.018.567 4.345-.009l369.758-163.128-369.706-175.464v-.01c-1.326-.628-3.158-.636-4.502 0l-370.108 175.37zm748.015 1.858h.175-.175zM512.376 941.674c-10.348 0-20.8-2.32-30.537-6.997L121.05 778.624c-18.113-7.834-26.454-28.87-18.62-46.983 7.835-18.112 28.862-26.488 46.993-18.61l362.08 156.629 345.26-156.366c17.939-8.166 39.14-.253 47.324 17.746 8.166 17.964.227 39.157-17.729 47.324l-344.51 156.61c-9.196 4.449-19.281 6.7-29.471 6.7z" fill="#444"/><path d="M871.563 515.449L511.81 671.775 152.358 515.787v73.578a34.248 34.248 0 0 0 20.76 31.48l301.518 129.19c11.806 5.703 24.499 8.546 37.175 8.546s25.367-2.843 37.174-8.546L850.82 620.534a34.248 34.248 0 0 0 20.744-31.474V515.45z" fill="#ff6a18"/></svg>\n                                <a class="link" target="_blank" rel="noopener noreferrer" href="${_.category.length&&_.category[0].permalink}">${_.category.length&&_.category[0].name}</a>\n                            </div>\n                        </div>\n                    </li>\n                `:`\n                    <li class="joe_list__item wow none">\n                        <div class="line"></div>\n                        <div class="information">\n                            <a href="${_.permalink}" class="title" title="${_.title}" target="_blank" rel="noopener noreferrer">\n                                <span class="badge" style="display: ${"sticky"===_.type?"inline-block":"none"}">置顶</span>${_.title}\n                            </a>\n                            <a class="abstract" href="${_.permalink}" title="文章摘要" target="_blank" rel="noopener noreferrer">${_.abstract}</a>\n                            <div class="meta">\n                                <ul class="items">\n                                    <li>${_.created}</li>\n                                    <li>${_.views} 阅读</li>\n                                    <li>${_.commentsNum} 评论</li>\n                                    <li>${_.agree} 点赞</li>\n                                </ul>\n                                <div class="last" style="display: ${_.category.length?"flex":"none"}">\n                                    <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M512.2 564.743a76.818 76.818 0 0 1-30.973-6.508L108.224 393.877c-26.105-11.508-42.56-35.755-42.927-63.272-.384-27.44 15.356-52.053 41.042-64.232l373.004-176.74c20.591-9.737 45.16-9.755 65.75.017L917.68 266.39c25.668 12.188 41.39 36.792 41.024 64.231-.384 27.5-16.821 51.73-42.908 63.237l-372.57 164.377a77.18 77.18 0 0 1-31.025 6.508zM139.843 329.592l370.213 163.241c1.291.56 3.018.567 4.345-.009l369.758-163.128-369.706-175.464v-.01c-1.326-.628-3.158-.636-4.502 0l-370.108 175.37zm748.015 1.858h.175-.175zM512.376 941.674c-10.348 0-20.8-2.32-30.537-6.997L121.05 778.624c-18.113-7.834-26.454-28.87-18.62-46.983 7.835-18.112 28.862-26.488 46.993-18.61l362.08 156.629 345.26-156.366c17.939-8.166 39.14-.253 47.324 17.746 8.166 17.964.227 39.157-17.729 47.324l-344.51 156.61c-9.196 4.449-19.281 6.7-29.471 6.7z" fill="#444"/><path d="M871.563 515.449L511.81 671.775 152.358 515.787v73.578a34.248 34.248 0 0 0 20.76 31.48l301.518 129.19c11.806 5.703 24.499 8.546 37.175 8.546s25.367-2.843 37.174-8.546L850.82 620.534a34.248 34.248 0 0 0 20.744-31.474V515.45z" fill="#ff6a18"/></svg>\n                                    <a class="link" target="_blank" rel="noopener noreferrer" href="${_.category.length&&_.category[0].permalink}">${_.category.length&&_.category[0].name}</a>\n                                </div>\n                            </div>\n                        </div>\n                    </li>\n                `)(_))),$(".joe_load").removeAttr("loading"),$(".joe_load").html("查看更多"),$(".joe_index__list .joe_list__loading").hide(),reslove(res.data.length>0?res.data.length-1:0)}})});$(".joe_index__title-title .item").on("click",(async function(){$(this).attr("data-type")!==queryData.type&&(queryData={page:1,pageSize:window.Joe.PAGE_SIZE,type:$(this).attr("data-type")},(()=>{$(".joe_index__list .joe_list").html(""),$(".joe_load").show();let activeItem=$('.joe_index__title-title .item[data-type="'+queryData.type+'"]'),activeLine=$(".joe_index__title-title .line");activeItem.addClass("active").siblings().removeClass("active"),activeLine.css({left:activeItem.position().left,width:activeItem.width()})})(),pushDom())})),$(".joe_load").on("click",(async function(){if($(this).attr("loading"))return;queryData.page++;let length=await pushDom();length=$(".joe_index__list .joe_list .joe_list__item").length-length;const offset=$(`.joe_index__list .joe_list .joe_list__item:nth-child(${length})`).offset().top-$(".joe_header").height();window.scrollTo({top:offset-15,behavior:"smooth"})}))},initListEffect(){const wow=$(".joe_index__list").attr("data-wow");"off"!==wow&&wow&&new WOW({boxClass:"wow",animateClass:`animated ${wow}`,offset:0,mobile:!0,live:!0,scrollContainer:null}).init()},initToc(){ThemeConfig.enable_toc&&$(".toc-container").length&&(document.body.clientWidth<=1200||(tocbot.init({tocSelector:"#js-toc",contentSelector:".joe_detail__article",ignoreSelector:".js-toc-ignore",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:ThemeConfig.tocDepth||0,hasInnerContainers:!1,headingsOffset:-80,scrollSmoothOffset:-70,positionFixedSelector:".toc-container",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"}),$(".toc-container").show(),$(".toc-expander i").on("click",(function(){$(this).parents(".toc-container").toggleClass("hide")}))))},initCopy(){if(!ThemeConfig.enable_copy||!$(".joe_post").length)return;const curl=$(".joe_detail").attr("data-curl");$(".joe_post").on("copy",(function(e){const body_element=document.body,selection=window.getSelection(),appendLink=`作者：${ThemeConfig.author}<br>\n          链接：${curl}<br>\n          来源：${ThemeConfig.blog_title}<br>\n          著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。`;if(window.clipboardData){const copytext=selection+"\r\n\r\n"+appendLink;return window.clipboardData.setData("Text",copytext),!1}{const copytext=selection+"<br><br>"+appendLink,newdiv=document.createElement("div");newdiv.style.position="absolute",newdiv.style.left="-99999px",body_element.appendChild(newdiv),newdiv.innerHTML=copytext,selection.selectAllChildren(newdiv),setTimeout((function(){body_element.removeChild(newdiv)}),0)}}))},initBaidu(){ThemeConfig.check_baidu_collect&&$("#joe_baidu_record").length&&$.ajax({url:ThemeConfig.BASE_URL+"/halo-api/bd/iscollect",type:"GET",dataType:"json",data:{url:window.location.href},success(res){if(res.data&&res.data.collected)$("#joe_baidu_record").css("color","#67c23a").html("已收录");else if(ThemeConfig.baidu_token){$("#joe_baidu_record").html('<span style="color: #e6a23c">未收录，推送中...</span>');const _timer=setTimeout((function(){$.ajax({url:ThemeConfig.BASE_URL+"/halo-api/bd/push",type:"POST",dataType:"json",data:{site:ThemeConfig.HOST,token:ThemeConfig.baidu_token,urls:window.location.href},success(res){0===res.data.success?$("#joe_baidu_record").html('<span style="color: #f56c6c">推送失败，请检查！</span>'):$("#joe_baidu_record").html('<span style="color: #67c23a">推送成功！</span>')}}),clearTimeout(_timer)}),1e3)}else{const url=`https://ziyuan.baidu.com/linksubmit/url?sitename=${encodeURI(window.location.href)}`;$("#joe_baidu_record").html(`<a target="_blank" href="${url}" rel="noopener noreferrer nofollow" style="color: #f56c6c">未收录，提交收录</a>`)}},error(err){console.log(err)}})},initCode(){(ThemeConfig.enable_code_expander||ThemeConfig.enable_code_copy)&&$("pre[class*='language-']").length&&$("pre[class*='language-']").each((function(index,item){if(ThemeConfig.enable_code_expander){const $item=$(item),expander=$('<i class="joe-font joe-icon-arrow-downb code-expander" title="折叠/展开"></i>');if(expander.on("click",(function(){const $auto_fold=expander.parent("pre").siblings(".toolbar").find(".autofold-tip");$auto_fold&&$auto_fold.remove(),expander.parent("pre").toggleClass("close")})),$item.prepend(expander),ThemeConfig.fold_long_code&&location.pathname.includes("archives")&&$item.height()>(ThemeConfig.long_code_height||200)){$item.siblings(".toolbar").find(".toolbar-item span").eq(0).append('<em class="autofold-tip"><内容过长，已自动折叠></em>'),$item.addClass("close")}}if(ThemeConfig.enable_code_copy){const text=$(item).find("code[class*='language-']").text(),span=$('<span class="copy-button"><i class="joe-font joe-icon-copy" title="复制代码"></i></span>');new ClipboardJS(span[0],{text:()=>text+"\r\n\r\n"+ThemeConfig.copy_right_text}).on("success",()=>Qmsg.success("复制成功！")),$(item).addClass("copyable").append(span)}}))},initAside(){(ThemeConfig.enable_aside||ThemeConfig.enable_aside_expander)&&$(".aside-expander").on("click",(function(){const $this=$(this);$this.hasClass("active")?($this.removeClass("active"),$this.html("隐藏侧边栏")):($this.addClass("active"),$this.html("显示侧边栏")),$(".joe_aside").toggleClass("hide")}))},initGallery(){$(".joe_detail__article img:not(img.owo_image), .joe_journal_block img").each((function(){$(this).wrap($(`<span style="display: block;" data-fancybox="Joe" href="${$(this).attr("src")}"></span>`))}))},initPostShare(){ThemeConfig.enable_share&&(ThemeConfig.enable_share_link&&$(".icon-share-link").length&&new ClipboardJS($(".icon-share-link")[0],{text:()=>location.href}).on("success",()=>Qmsg.success("文章链接已复制")),ThemeConfig.enable_share_weixin&&$("#qrcode_wx").length&&$("#qrcode_wx").qrcode({width:140,height:140,render:"canvas",typeNumber:-1,correctLevel:0,background:"#ffffff",foreground:"#000000",text:location.href}))},initExternalLink(){$(".joe_detail__article a:not(.joe_detail__article-anote)").each((function(){$(this).attr({target:"_blank",rel:"noopener noreferrer nofollow"})}))},initLike(){if(!ThemeConfig.enable_like||!$(".joe_detail__agree").length)return;const cid=$(".joe_detail").attr("data-cid"),clikes=+($(".joe_detail").attr("data-clikes")||0);let agreeArr=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[];const $icons=$(".joe_detail__agree .icon"),$iconLike=$(".joe_detail__agree .icon-like"),$iconUnlike=$(".joe_detail__agree .icon-unlike"),$likeNum=$(".joe_detail__agree .text");agreeArr.includes(cid)?$iconUnlike.addClass("active"):$iconLike.addClass("active"),$likeNum.html(clikes);let _loading=!1;$iconLike.on("click",(function(){if(_loading)return;_loading=!0,agreeArr=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[];let flag=agreeArr.includes(cid);$.ajax({url:"/api/content/posts/"+cid+"/likes",type:"POST",dataType:"json",data:{type:flag?"disagree":"agree"},success(res){if(200!==res.status)return;let likes=clikes;if(flag){likes--;const index=agreeArr.findIndex(_=>_===cid);agreeArr.splice(index,1),$iconUnlike.removeClass("active"),$iconLike.addClass("active"),$icons.removeClass("active")}else likes++,agreeArr.push(cid),$iconLike.removeClass("active"),$iconUnlike.addClass("active"),$icons.addClass("active");const name=encryption("agree"),val=encryption(JSON.stringify(agreeArr));localStorage.setItem(name,val),$likeNum.html(likes)},error:err=>(_loading=!1,Qmsg.warning(err.responseJSON.message)),complete(){_loading=!1}})}))},initVideo(){if($(".joe_detail__article-video").length){const player=$(".joe_detail__article-video .play iframe").attr("data-player");$(".joe_detail__article-video .episodes .item").on("click",(function(){$(this).addClass("active").siblings().removeClass("active");const url=$(this).attr("data-src");$(".joe_detail__article-video .play iframe").attr({src:player+url})})),$(".joe_detail__article-video .episodes .item").first().click()}},initJournals(){$(".journal_content_expander").on("click",(function(){$(this).parent().toggleClass("open")}));const $allItems=$(".joe_journal__item");$allItems.length&&$allItems.each((function(_,item){const $this=$(this),cid=$this.attr("data-cid"),clikes=+($this.attr("data-clikes")||0);let agreeArr=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[];const $iconLike=$this.find(".journal-like"),$iconUnlike=$this.find(".journal-unlike"),$likeNum=$this.find(".journal-likes-num");agreeArr.includes(cid)?($iconLike.hide(),$iconUnlike.show()):($iconLike.show(),$iconUnlike.hide()),$likeNum.html(clikes),$iconLike.on("click",(function(){let _loading=!1;if(_loading)return;_loading=!0,agreeArr=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[];let flag=agreeArr.includes(cid);$.ajax({url:"/api/content/journals/"+cid+"/likes",type:"POST",dataType:"json",data:{type:flag?"disagree":"agree"},success(res){if(200!==res.status)return;let likes=clikes;if(flag){likes--;const index=agreeArr.findIndex(_=>_===cid);agreeArr.splice(index,1),$iconLike.show(),$iconUnlike.hide()}else likes++,agreeArr.push(cid),$iconLike.hide(),$iconUnlike.show();const name=encryption("agree-journal"),val=encryption(JSON.stringify(agreeArr));localStorage.setItem(name,val),$likeNum.html(likes)},error:err=>(_loading=!1,Qmsg.warning(err.responseJSON.message)),complete(){_loading=!1}})}))})),ThemeConfig.enable_comment_journal&&$(".journal_comment_expander,.journal-comment").on("click",(function(){const $parent=$(this).parents(".footer-wrap");if(ThemeConfig.enable_autoload_comment_journal){const compComment=$parent.find("halo-comment")[0].shadowRoot.getElementById("halo-comment").__vue__;$parent.hasClass("open")||compComment.loaded||compComment.loadComments()}$parent.toggleClass("open"),$parent.find(".journal_comment_expander_txt").html(($parent.hasClass("open")?"收起":"查看")+"评论")}))},getLeavingData(){const sheetId=$(".joe_detail__title").attr("data-sheetid");$.ajax({url:`/api/content/sheets/${sheetId}/comments/top_view`,type:"GET",dataType:"json",success(res){if(200===res.status&&res.data){const resD=res.data;if(resD.total){const str=resD.content.reduce((sum,item)=>sum+`<li class="item">\n              <div class="user">\n                  <img class="avatar lazyload" src="${ThemeConfig.lazyload_avatar}" data-src="${item.authorUrl||item.avatar}" alt="用户头像" />\n                  <div class="nickname">${item.author}</div>\n                  <div class="date">${new Date(item.createTime).toLocaleDateString()}</div>\n              </div>\n              <div class="wrapper">\n                  <div class="content">${item.content}</div>\n              </div>\n          </li>`,"");$(".joe_detail__leaving-list").html(str),leavingContext.randomColor(),$(".joe_detail__leaving-list").show(),$(".joe_detail__leaving-none").hide()}else $(".joe_detail__leaving-list").hide(),$(".joe_detail__leaving-none").show()}else $(".joe_detail__leaving-list").hide(),$(".joe_detail__leaving-none").show()}})},randomColor(){let _index=100;const colors=["#dcc10c","#299bec","#EA5455","#7367F0","#32CCBC","#F6416C","#28C76F","#9F44D3","#F55555","#736EFE","#E96D71","#DE4313","#D939CD","#4C83FF","#F072B6","#C346C2","#5961F9","#FD6585","#465EFB","#FFC600","#FA742B","#5151E5","#BB4E75","#e255cd","#63c549","#0ECDDE","#F067B4","#F067B4","#ff9a9e","#1dd5de","#4facfe","#f093fb","#6fa3ef","#bc99c4","#46c47c","#f9bb3c","#e8583d","#f68e5f"],random=(min,max)=>Math.floor(Math.random()*(max-min+1))+min,maxWidth=$(".joe_detail__leaving-list").width(),maxHeight=$(".joe_detail__leaving-list").height(),radius1=["20px 300px","20px 400px","20px 500px","30px 300px","30px 400px","30px 500px","40px 300px","40px 400px","40px 500px"],radius2=["300px 20px","400px 20px","500px 20px","300px 30px","400px 30px","500px 30px","300px 40px","400px 40px","500px 40px"];$(".joe_detail__leaving-list .item").each((index,item)=>{const zIndex=random(1,99),background=colors[random(0,colors.length-1)],width=Math.ceil($(item).width()),height=Math.ceil($(item).height()),top=random(0,maxHeight-height),left=random(0,maxWidth-width);$(item).css({display:"block",zIndex:zIndex,background:background,top:top,left:left,borderTopLeftRadius:radius2[random(0,radius2.length-1)],borderTopRightRadius:radius1[random(0,radius1.length-1)],borderBottomLeftRadius:radius1[random(0,radius1.length-1)],borderBottomRightRadius:radius1[random(0,radius1.length-1)]}),$(item).draggabilly({containment:!0}),$(item).on("dragStart",e=>{_index++,$(item).css({zIndex:_index})})})},initMathjax(){ThemeConfig.enable_mathjax&&window.katex&&renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})},initArchive(){let page=0;const initFiling=()=>{"loading..."!==$(".joe_census__filing .button").html()&&$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"article_filing",page:++page},success(res){if(!res.length)return $(".joe_census__filing .item.load").remove(),Qmsg.warning("没有更多内容了");let htmlStr="";res.forEach(item=>{htmlStr+=`\n\t\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t\t<div class="tail"></div>\n\t\t\t\t\t\t\t\t<div class="head"></div>\n\t\t\t\t\t\t\t\t<div class="wrapper">\n\t\t\t\t\t\t\t\t\t<div class="panel">${item.date}<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M21.6 772.8c28.8 28.8 74.4 28.8 103.2 0L512 385.6l387.2 387.2c28.8 28.8 74.4 28.8 103.2 0 28.8-28.8 28.8-74.4 0-103.2L615.2 282.4l-77.6-77.6c-14.4-14.4-37.6-14.4-51.2 0l-77.6 77.6L21.6 669.6c-28.8 28.8-28.8 75.2 0 103.2z" /></svg></div>\n\t\t\t\t\t\t\t\t\t<ol class="panel-body">\n\t\t\t\t\t\t\t\t\t\t${item.list.map(_=>`<li><a rel="noopener noreferrer" target="_blank" href="${_.permalink}">${_.title}</a></li>`).join("")}\n\t\t\t\t\t\t\t\t\t</ol>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`}),$("#filing").append(htmlStr),$(".joe_census__filing .button").html("加载更多")}})};initFiling(),$(".joe_census__filing .content").on("click",".panel",(function(){const panelBox=$(this).parents(".content");panelBox.find(".panel").not($(this)).removeClass("in"),panelBox.find(".panel-body").not($(this).siblings(".panel-body")).stop().hide("fast"),$(this).toggleClass("in").siblings(".panel-body").stop().toggle("fast")})),$(".joe_census__filing .button").on("click",(function(){initFiling(),$(this).html("loading...")}))}};document.addEventListener("DOMContentLoaded",(function(){Object.values(JoeContext).forEach(item=>item())})),window.addEventListener("load",(function(){{const scroll=new URLSearchParams(location.search).get("scroll");if(scroll){const height=$(".joe_header").height();let elementEL=null;if(elementEL=$("#"+scroll).length>0?$("#"+scroll):$("."+scroll),elementEL&&elementEL.length>0){const top=elementEL.offset().top-height-15;window.scrollTo({top:top,behavior:"smooth"})}}}$(".joe_journal_body .content-wrp").each((function(){$(this)[0].getBoundingClientRect().height>270&&$(this).siblings(".journal_content_expander").show()}))}));